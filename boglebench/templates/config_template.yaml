# BogleBench Configuration Template
# Copy this file to your data directory and customize as needed

# Data file locations and paths
data:
  base_path: "~/boglebench_data"
  transactions_file: "input/sample_transactions.csv"
  attributes_file: "input/sample_attributions.csv"
  market_data_cache: "market_data/"
  output_path: "output/"

# API configuration for market data providers
api:
  # Alpha Vantage API key - get free key from https://www.alphavantage.co/support/#api-key
  alpha_vantage_key: "YOUR_ALPHA_VANTAGE_API_KEY_HERE"
  data_provider: "alpha_vantage" # Options: alpha_vantage, yahoo_finance

# Analysis settings
settings:
  default_currency: "USD"
  cache_market_data: true
  force_refresh_market_data: false

# Portfolio analysis configuration
analysis:
  start_date: null # If null, uses first transaction date
  end_date: null # If null, uses today
  # Optional: Specify a risk-free rate for Sharpe Ratio calculation.
  risk_free_rate: 0.02 # 2% annual risk-free rate
  brinson_max_workers: 4 # Max parallel workers for Brinson attribution analysis

  # Performance metrics to calculate
  performance_metrics:
    - "total_return"
    - "annualized_return"
    - "volatility"
    - "sharpe_ratio"
    - "max_drawdown"
    - "information_ratio"
    - "beta"
    - "jensens_alpha"
    - "win_rate"
    - "tracking_error"
    - "correlation"

  attribution_analysis:
    enabled: true
    method: "Brinson" # Options: Brinson, Brinson-Fachler
    attributes_to_analyze: # List of attributes to analyze for attribution; if empty, uses all available attributes
      - "asset_class"
      - "sector"

# Benchmark settings
benchmark:
  rebalance_frequency: "monthly" # Options: daily, weekly, monthly, quarterly, yearly, none
  name: "Blended US/Intl Eqty + Bond 20/40/40" # Descriptive name for reports
  components:
    - symbol: "VTI" # Vanguard Total Stock Market ETF
      weight: 0.20
    - symbol: "VXUS" # Vanguard Total International Stock ETF
      weight: 0.40
    - symbol: "BND" # Vanguard Total Bond Market ETF
      weight: 0.40

  # Risk analysis settings
  risk_analysis:
    confidence_level: 0.95 # For VaR calculations
    rolling_window: 252 # Trading days for rolling metrics (1 year)

# Logging configuration
logging:
  level: "INFO" # Options: DEBUG, INFO, WARNING, ERROR
  log_to_file: true
  log_file: "logs/boglebench.log"

  # Log rotation settings
  rotation:
    max_file_size_mb: 10 # Rotate when file reaches 10MB
    backup_count: 5 # Keep 5 rotated files
    error_log_days: 30 # Keep error logs for 30 days

# Chart and visualization settings
visualization:
  default_style: "seaborn"
  figure_size: [12, 8]
  dpi: 300
  save_format: "png" # Options: png, pdf, svg

  # Chart colors (Bogle-inspired simple palette)
  colors:
    portfolio: "#1f77b4" # Blue
    benchmark: "#ff7f0e" # Orange
    positive: "#2ca02c" # Green
    negative: "#d62728" # Red
    neutral: "#7f7f7f" # Gray

# Advanced settings (for power users)
advanced:
  # Market data settings
  market_data:
    max_cache_age_days: 7
    retry_attempts: 3
    request_delay_seconds: 0.5
    local_tz: "America/New_York"

  dividend:
    auto_validate: true # Automatically validate during portfolio building
    auto_calculate_div_per_share: true # Calculate missing div_per_share from holdings
    warn_missing_dividends: true # Warn about market dividends not in user data
    default_div_type: "CASH" # Default dividend type
    comparison_error_margin: 0.01 # Acceptable difference for matching
    # Handle dividends that occur after last transaction but before end_date
    # Options:
    #   "ignore" - Skip these dividends (default, safe approach)
    #   "add_to_all_accounts" - Automatically add dividend transactions to all accounts holding the symbol
    handle_future_dividends: "ignore"

  # Portfolio calculation settings
  portfolio:
    handle_missing_prices: "forward_fill" # Options: forward_fill, interpolate, skip
    price_adjustment: "split_adjusted" # Options: split_adjusted, total_return

  # Performance calculation settings
  performance:
    annualization_factor: 252 # Trading days per year
    compound_returns: true
    handle_negative_values: "log_returns" # Options: log_returns, simple_returns
    modified_dietz_periodic_cash_flow_weight: 0.5 # Assume cash flows occurs mid-period

# Transaction validation rules
validation:
  # Date format requirements
  date_format: "ISO8601" # YYYY-MM-DD format required

  # Transaction validation
  allow_future_dates: false
  allow_zero_prices: false
  allow_fractional_shares: true

  # Data quality checks
  warn_on_weekends: true
  warn_on_holidays: true
  warn_on_missing_data: true

  # Short position handling
  # BogleBench cannot properly handle short positions (negative holdings).
  # This setting controls how to handle transactions that would result in short positions.
  # Options:
  #   "reject" - Reject any transaction that would result in a short position (raises error)
  #   "cap" - Cap the transaction to the available long position (resulting in zero holdings)
  #   "ignore" - Log warning but allow short positions (portfolio metrics may be incorrect)
  short_position_handling: "reject" # Options: reject, cap, ignore

# Database configuration
database:
  # Path to portfolio history database file
  db_path: "portfolio_history.db" # Relative to base_path, or absolute path
  # db_path: null  # If null, uses default: {base_path}/portfolio_history.db

  # Optional: Database performance settings
  optimize_on_close: false # Run VACUUM and ANALYZE when closing
  cache_size_mb: 64 # SQLite cache size in MB

  journal_mode: "WAL" # SQLite journal mode
  synchronous: "NORMAL" # SQLite synchronous mode
  vacuum_on_close: false # Run VACUUM when closing database

  # Data management
  backup:
    enabled: false # Auto-backup database before major operations
    path: "backups/" # Backup directory
    retention_days: 30 # How long to keep backups
